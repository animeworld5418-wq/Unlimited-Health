-- Devil Neon V5 (All-in-one) by ChatGPT
-- Features: Galaxy Loading, Movable UI, Invincibility, Auto-Regenerate, Aura Selector, Memory Saver
-- Paste into executor (runs as LocalScript in CoreGui)

-- Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local HttpService = game:GetService("HttpService")
local player = Players.LocalPlayer
local CoreGui = game:GetService("CoreGui")

-- Safe remove old
if CoreGui:FindFirstChild("DevilNeonV5") then
    CoreGui.DevilNeonV5:Destroy()
end

-- ---------- Memory helpers (writefile/readfile fallback) ----------
local storageFile = "devil_neon_v5.json"
local persistent = {}
local function saveSettings()
    local ok, data = pcall(function() return HttpService:JSONEncode(persistent) end)
    if not ok then return end
    if writefile then
        pcall(function() writefile(storageFile, data) end)
    end
end
local function loadSettings()
    if readfile then
        local ok, s = pcall(function() return readfile(storageFile) end)
        if ok and s then
            local ok2, tbl = pcall(function() return HttpService:JSONDecode(s) end)
            if ok2 and type(tbl)=="table" then
                persistent = tbl
            end
        end
    end
end
-- defaults
persistent.on = false
persistent.aura = "Purple"

-- try load
loadSettings()

-- ---------- Utility ----------
local function safePlaySound(parent, soundId, volume)
    local s = Instance.new("Sound")
    s.SoundId = soundId
    s.Volume = volume or 1
    s.PlayOnRemove = false
    s.Parent = parent or workspace
    s:Play()
    game.Debris:AddItem(s, 4)
end

-- color map for aura selector
local AuraColors = {
    Purple = Color3.fromRGB(200, 0, 255),
    Red    = Color3.fromRGB(255, 50, 50),
    Blue   = Color3.fromRGB(60, 160, 255),
    Green  = Color3.fromRGB(0, 220, 120)
}

-- ---------- Create Loading Screen ----------
local screen = Instance.new("ScreenGui")
screen.Name = "DevilNeonV5"
screen.ResetOnSpawn = false
screen.Parent = CoreGui
screen.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- full-screen fade frame (transparent background for no black overlay)
local loadFrame = Instance.new("Frame", screen)
loadFrame.Name = "LoadFrame"
loadFrame.AnchorPoint = Vector2.new(0.5,0.5)
loadFrame.Size = UDim2.new(1,0,1,0)
loadFrame.Position = UDim2.new(0.5,0.5,0.5,0)
loadFrame.BackgroundTransparency = 1

-- centered loader container
local loader = Instance.new("Frame", loadFrame)
loader.Size = UDim2.new(0, 560, 0, 160)
loader.Position = UDim2.new(0.5, -280, 0.5, -80)
loader.BackgroundColor3 = Color3.fromRGB(8,8,12)
loader.BackgroundTransparency = 0
Instance.new("UICorner", loader).CornerRadius = UDim.new(0, 16)
loader.BorderSizePixel = 0
loader.ClipsDescendants = true

-- subtle stroke
local sstroke = Instance.new("UIStroke", loader)
sstroke.Thickness = 2
sstroke.Color = Color3.fromRGB(180,0,220)
sstroke.Transparency = 0.4

-- galaxy background inside loader (image)
local loaderBG = Instance.new("ImageLabel", loader)
loaderBG.Size = UDim2.new(1,0,1,0)
loaderBG.BackgroundTransparency = 1
loaderBG.Image = "https://i.imgur.com/AgE7FHZ.jpg"
loaderBG.ImageTransparency = 0.15
loaderBG.ScaleType = Enum.ScaleType.Crop

-- title (typewriter) label
local titleLbl = Instance.new("TextLabel", loader)
titleLbl.Size = UDim2.new(1,-40,0,44)
titleLbl.Position = UDim2.new(0,20,0,12)
titleLbl.BackgroundTransparency = 1
titleLbl.Font = Enum.Font.GothamBold
titleLbl.TextSize = 28
titleLbl.TextColor3 = Color3.fromRGB(255,200,255)
titleLbl.TextXAlignment = Enum.TextXAlignment.Left
titleLbl.TextYAlignment = Enum.TextYAlignment.Center
titleLbl.Text = ""

-- subtitle small
local sub = Instance.new("TextLabel", loader)
sub.Size = UDim2.new(1,-40,0,20)
sub.Position = UDim2.new(0,20,0,54)
sub.BackgroundTransparency = 1
sub.Font = Enum.Font.Gotham
sub.TextSize = 14
sub.TextColor3 = Color3.fromRGB(200,200,255)
sub.Text = "Initializing Devil Neon System..."

-- loading bar
local barBg = Instance.new("Frame", loader)
barBg.Size = UDim2.new(0.9,0,0,18)
barBg.Position = UDim2.new(0.05,0,0,86)
barBg.BackgroundColor3 = Color3.fromRGB(30,30,40)
barBg.BorderSizePixel = 0
Instance.new("UICorner", barBg).CornerRadius = UDim.new(1,0)

local barFill = Instance.new("Frame", barBg)
barFill.Size = UDim2.new(0,0,1,0)
barFill.BackgroundColor3 = Color3.fromRGB(255,0,200)
Instance.new("UICorner", barFill).CornerRadius = UDim.new(1,0)

-- spark particle (small UI spark)
local spark = Instance.new("ImageLabel", barBg)
spark.Size = UDim2.new(0, 24, 0, 24)
spark.AnchorPoint = Vector2.new(0.5, 0.5)
spark.Position = UDim2.new(0, 0, 0.5, 0)
spark.BackgroundTransparency = 1
spark.Image = "rbxassetid://3570695787" -- circular sprite (builtin)
spark.ImageColor3 = Color3.fromRGB(255,255,255)
spark.Visible = false

-- small ready text
local ready = Instance.new("TextLabel", loader)
ready.Size = UDim2.new(1,-40,0,20)
ready.Position = UDim2.new(0,20,0,112)
ready.BackgroundTransparency = 1
ready.Font = Enum.Font.Gotham
ready.TextSize = 14
ready.TextColor3 = Color3.fromRGB(180,180,255)
ready.Text = ""

-- fade in loader
loader.BackgroundTransparency = 1
loaderBG.ImageTransparency = 1
TweenService:Create(loader, TweenInfo.new(0.8, Enum.EasingStyle.Quad), {BackgroundTransparency = 0}):Play()
TweenService:Create(loaderBG, TweenInfo.new(0.9, Enum.EasingStyle.Quad), {ImageTransparency = 0.15}):Play()

-- typewriter effect
local textToType = "âš¡ Initializing Devil Neon System âš¡"
task.spawn(function()
    local displayed = ""
    for i=1,#textToType do
        displayed = string.sub(textToType, 1, i)
        titleLbl.Text = displayed
        task.wait(0.03)
    end
end)

-- loading bar fill with spark
task.spawn(function()
    for i=1,100 do
        local frac = i/100
        pcall(function()
            barFill:TweenSize(UDim2.new(frac,0,1,0), Enum.EasingDirection.Out, Enum.EasingStyle.Quad, 0.03, true)
        end)
        spark.Visible = true
        local sparkX = math.clamp(frac * barBg.AbsoluteSize.X, 12, barBg.AbsoluteSize.X-12)
        spark.Position = UDim2.new(0, sparkX, 0.5, 0)
        task.wait(0.03 + (math.sin(i/8)*0.003))
    end
    ready.Text = "Ready"
    safePlaySound(workspace, "rbxassetid://138221250", 0.8) -- small ready sound
    task.wait(0.25)
    -- fade out loader
    TweenService:Create(loader, TweenInfo.new(0.45, Enum.EasingStyle.Quad), {BackgroundTransparency = 1}):Play()
    TweenService:Create(loaderBG, TweenInfo.new(0.45, Enum.EasingStyle.Quad), {ImageTransparency = 1}):Play()
    TweenService:Create(titleLbl, TweenInfo.new(0.45, Enum.EasingStyle.Quad), {TextTransparency = 1}):Play()
    TweenService:Create(sub, TweenInfo.new(0.45, Enum.EasingStyle.Quad), {TextTransparency = 1}):Play()
    TweenService:Create(barBg, TweenInfo.new(0.45, Enum.EasingStyle.Quad), {BackgroundTransparency = 1}):Play()
    task.wait(0.5)
    loadFrame:Destroy()
end)

-- ---------- Main Compact UI ----------
local main = Instance.new("Frame")
main.Name = "Main"
main.Size = UDim2.new(0, 320, 0, 220)
main.Position = UDim2.new(0.5, -160, 0.5, -110)
main.BackgroundTransparency = 1
main.Parent = screen
Instance.new("UICorner", main).CornerRadius = UDim.new(0, 14)

-- container (visible part)
local container = Instance.new("Frame", main)
container.Size = UDim2.new(1,0,1,0)
container.Position = UDim2.new(0,0,0,0)
container.BackgroundColor3 = Color3.fromRGB(12,12,18)
container.BorderSizePixel = 0
container.BackgroundTransparency = 0
Instance.new("UICorner", container).CornerRadius = UDim.new(0, 14)

local strokeMain = Instance.new("UIStroke", container)
strokeMain.Thickness = 2
strokeMain.Color = Color3.fromRGB(255, 0, 180)

-- galaxy bg inside
local mainBG = Instance.new("ImageLabel", container)
mainBG.Size = UDim2.new(1,0,1,0)
mainBG.BackgroundTransparency = 1
mainBG.Image = "https://i.imgur.com/AgE7FHZ.jpg"
mainBG.ImageTransparency = 0.12
mainBG.ScaleType = Enum.ScaleType.Crop

-- title
local title = Instance.new("TextLabel", mainBG)
title.Size = UDim2.new(1,-40,0,36)
title.Position = UDim2.new(0,18,0,8)
title.BackgroundTransparency = 1
title.Font = Enum.Font.GothamBold
title.TextSize = 18
title.Text = "ðŸ˜ˆ Devil Neon - Unlimited Health"
title.TextColor3 = Color3.fromRGB(220,200,255)
title.TextXAlignment = Enum.TextXAlignment.Left

-- close button
local closeBtn = Instance.new("TextButton", mainBG)
closeBtn.Size = UDim2.new(0,34,0,30)
closeBtn.Position = UDim2.new(1,-42,0,6)
closeBtn.Text = "X"
closeBtn.Font = Enum.Font.GothamBold
closeBtn.TextSize = 18
closeBtn.BackgroundColor3 = Color3.fromRGB(255,0,150)
Instance.new("UICorner", closeBtn).CornerRadius = UDim.new(1,0)

-- status
local status = Instance.new("TextLabel", mainBG)
status.Size = UDim2.new(1,-40,0,26)
status.Position = UDim2.new(0,18,0,48)
status.BackgroundTransparency = 1
status.Font = Enum.Font.Gotham
status.TextSize = 15
status.Text = "Status: OFF"
status.TextColor3 = Color3.fromRGB(255,90,90)
status.TextXAlignment = Enum.TextXAlignment.Left

-- health bar
local hbBg = Instance.new("Frame", mainBG)
hbBg.Size = UDim2.new(0.9,0,0,12)
hbBg.Position = UDim2.new(0.05,0,0,80)
hbBg.BackgroundColor3 = Color3.fromRGB(40,40,40)
hbBg.BorderSizePixel = 0
Instance.new("UICorner", hbBg).CornerRadius = UDim.new(1,0)

local hbFill = Instance.new("Frame", hbBg)
hbFill.Size = UDim2.new(1,0,1,0)
hbFill.BackgroundColor3 = Color3.fromRGB(0,255,140)
Instance.new("UICorner", hbFill).CornerRadius = UDim.new(1,0)

-- info text
local info = Instance.new("TextLabel", mainBG)
info.Size = UDim2.new(1,-36,0,40)
info.Position = UDim2.new(0,18,0,100)
info.BackgroundTransparency = 1
info.Font = Enum.Font.Gotham
info.TextSize = 14
info.Text = "Toggle Unlimited Health. Auto-regen triggers below 50% while ON."
info.TextColor3 = Color3.fromRGB(200,200,220)
info.TextWrapped = true
info.TextXAlignment = Enum.TextXAlignment.Left

-- ON/OFF Buttons
local onBtn = Instance.new("TextButton", mainBG)
onBtn.Size = UDim2.new(0,120,0,40)
onBtn.Position = UDim2.new(0,18,1,-60)
onBtn.Text = "ON"
onBtn.Font = Enum.Font.GothamBold
onBtn.TextSize = 20
onBtn.BackgroundColor3 = Color3.fromRGB(0,255,150)
Instance.new("UICorner", onBtn).CornerRadius = UDim.new(0,8)

local offBtn = Instance.new("TextButton", mainBG)
offBtn.Size = UDim2.new(0,120,0,40)
offBtn.Position = UDim2.new(1,-138,1,-60)
offBtn.Text = "OFF"
offBtn.Font = Enum.Font.GothamBold
offBtn.TextSize = 20
offBtn.BackgroundColor3 = Color3.fromRGB(210,50,50)
Instance.new("UICorner", offBtn).CornerRadius = UDim.new(0,8)

-- Aura selector label + dropdown
local auraLabel = Instance.new("TextLabel", mainBG)
auraLabel.Size = UDim2.new(0,120,0,20)
auraLabel.Position = UDim2.new(0,18,0,148)
auraLabel.BackgroundTransparency = 1
auraLabel.Font = Enum.Font.Gotham
auraLabel.TextSize = 14
auraLabel.Text = "Aura:"
auraLabel.TextColor3 = Color3.fromRGB(200,200,220)
auraLabel.TextXAlignment = Enum.TextXAlignment.Left

local auraDrop = Instance.new("TextButton", mainBG)
auraDrop.Size = UDim2.new(0,160,0,26)
auraDrop.Position = UDim2.new(0,60,0,144)
auraDrop.Text = persistent.aura or "Purple"
auraDrop.Font = Enum.Font.GothamBold
auraDrop.TextSize = 14
auraDrop.BackgroundColor3 = Color3.fromRGB(28,28,34)
Instance.new("UICorner", auraDrop).CornerRadius = UDim.new(0,6)

-- dropdown list frame (hidden)
local dropList = Instance.new("Frame", mainBG)
dropList.Position = UDim2.new(0,60,0,170)
dropList.Size = UDim2.new(0,160,0,0)
dropList.BackgroundColor3 = Color3.fromRGB(20,20,26)
dropList.BorderSizePixel = 0
dropList.ClipsDescendants = true
Instance.new("UICorner", dropList).CornerRadius = UDim.new(0,6)

local auraOptions = {"Purple","Red","Blue","Green"}
for i,opt in ipairs(auraOptions) do
    local b = Instance.new("TextButton", dropList)
    b.Size = UDim2.new(1,0,0,28)
    b.Position = UDim2.new(0,0,0,(i-1)*28)
    b.Text = opt
    b.Font = Enum.Font.Gotham
    b.TextSize = 14
    b.BackgroundColor3 = Color3.fromRGB(25,25,30)
    if i>1 then
        b.Position = UDim2.new(0,0,0,(i-1)*28)
    end
    b.AutoButtonColor = true
    b.MouseButton1Click:Connect(function()
        auraDrop.Text = opt
        persistent.aura = opt
        saveSettings()
        dropList:TweenSize(UDim2.new(0,160,0,0), TweenInfo.new(0.18), Enum.EasingDirection.Out, Enum.EasingStyle.Quad)
        applyAuraColor()
    end)
end

-- watermark
local wm = Instance.new("TextLabel", mainBG)
wm.Size = UDim2.new(0,180,0,20)
wm.Position = UDim2.new(1,-190,1,-22)
wm.BackgroundTransparency = 1
wm.Font = Enum.Font.Gotham
wm.TextSize = 13
wm.Text = "Â© Devil Neon System V5"
wm.TextColor3 = Color3.fromRGB(150,150,180)
wm.TextXAlignment = Enum.TextXAlignment.Right

-- ---------- Behavior: Invincibility, Aura, Floating Text ----------
local invincible = persistent.on or false
local humConn = nil
local charAddedConn = nil
local lastHumanoid = nil
local floatBillboard = nil

-- apply aura color helper
function applyAuraColor()
    local col = AuraColors[persistent.aura] or AuraColors.Purple
    -- update UI accent
    TweenService:Create(strokeMain, TweenInfo.new(0.2), {Color = col}):Play()
    -- update floating text & aura if present
    local char = player.Character
    if char then
        local hrp = char:FindFirstChild("HumanoidRootPart")
        if hrp then
            local pl = hrp:FindFirstChild("NeonAura")
            if pl and pl:IsA("PointLight") then
                pl.Color = col
            end
        end
        if floatBillboard and floatBillboard:FindFirstChildWhichIsA("TextLabel") then
            floatBillboard.TextLabel.TextColor3 = col
        end
    end
end

-- create aura (PointLight) & floating text
local function addAuraAndFloat()
    local char = player.Character
    if not char then return end
    local hrp = char:FindFirstChild("HumanoidRootPart") or char:WaitForChild("HumanoidRootPart", 5)
    if not hrp then return end
    if not hrp:FindFirstChild("NeonAura") then
        local pl = Instance.new("PointLight")
        pl.Name = "NeonAura"
        pl.Range = 14
        pl.Brightness = 3
        pl.Shadows = false
        pl.Parent = hrp
    end
    -- floating billboard
    if not char:FindFirstChild("Head") then return end
    if floatBillboard then floatBillboard:Destroy() end
    local bb = Instance.new("BillboardGui", char.Head)
    bb.Name = "DevilFloat"
    bb.Size = UDim2.new(0,200,0,50)
    bb.AlwaysOnTop = true
    bb.StudsOffset = Vector3.new(0,2.8,0)
    local lbl = Instance.new("TextLabel", bb)
    lbl.Size = UDim2.new(1,0,1,0)
    lbl.BackgroundTransparency = 1
    lbl.Font = Enum.Font.GothamBold
    lbl.Text = "ðŸ˜ˆ Devil Neon"
    lbl.TextScaled = true
    lbl.TextColor3 = AuraColors[persistent.aura] or AuraColors.Purple
    floatBillboard = bb
end

local function removeAuraAndFloat()
    local char = player.Character
    if char then
        if char:FindFirstChild("HumanoidRootPart") then
            local hrp = char.HumanoidRootPart
            if hrp:FindFirstChild("NeonAura") then
                hrp.NeonAura:Destroy()
            end
        end
        if floatBillboard then
            floatBillboard:Destroy()
            floatBillboard = nil
        end
    end
end

-- protective connection for a humanoid
local function protect(hum)
    if humConn then pcall(function() humConn:Disconnect() end) end
    lastHumanoid = hum
    humConn = hum:GetPropertyChangedSignal("Health"):Connect(function()
        if invincible then
            -- immediate prevent drop to 0
            pcall(function()
                if hum.Health < hum.MaxHealth then
                    hum.Health = hum.MaxHealth
                end
            end)
        end
    end)
    -- also monitor Died event as fail-safe
    pcall(function()
        hum.Died:Connect(function()
            if invincible then
                -- fail-safe: flash UI red and try to restore
                task.spawn(function()
                    local orig = container.BackgroundColor3
                    container.BackgroundColor3 = Color3.fromRGB(120,20,20)
                    wait(0.25)
                    container.BackgroundColor3 = orig
                end)
                -- Attempt to heal after tiny delay
                task.wait(0.05)
                pcall(function() hum.Health = hum.MaxHealth end)
            end
        end)
    end)
end

-- auto-regen pulse (lerp over 2 seconds)
local function autoRegen(hum)
    if not hum or not invincible then return end
    local start = hum.Health
    local target = hum.MaxHealth
    local duration = 2
    local t0 = tick()
    -- neon ripple effect
    local char = player.Character
    if char and char:FindFirstChild("HumanoidRootPart") then
        local ring = Instance.new("Part", workspace)
        ring.Anchored = true
        ring.CanCollide = false
        ring.Transparency = 0.6
        ring.Size = Vector3.new(1,0.2,1)
        ring.CFrame = char.HumanoidRootPart.CFrame * CFrame.new(0,-3,0)
        ring.BrickColor = BrickColor.new("Hot pink")
        game.Debris:AddItem(ring, 1)
    end
    while tick() - t0 < duration do
        local p = (tick() - t0)/duration
        pcall(function() hum.Health = start + (target - start) * p end)
        task.wait(0.03)
    end
    pcall(function() hum.Health = target end)
end

-- enabling/disabling functions
local function enableAll()
    invincible = true
    persistent.on = true
    saveSettings()
    status.Text = "Status: ON (Invincible)"
    status.TextColor3 = Color3.fromRGB(120,255,180)
    safePlaySound(workspace, "rbxassetid://12222142", 1) -- turn-on hum
    addAuraAndFloat()
    applyAuraColor()
    -- connect current char
    local char = player.Character or player.CharacterAdded:Wait()
    local hum = char:FindFirstChildOfClass("Humanoid")
    if hum then
        pcall(function() hum.Health = hum.MaxHealth end)
        protect(hum)
    end
    -- CharacterAdded reconnect
    if charAddedConn then pcall(function() charAddedConn:Disconnect() end) end
    charAddedConn = player.CharacterAdded:Connect(function(newChar)
        if invincible then
            repeat task.wait() until newChar:FindFirstChildOfClass("Humanoid")
            local nh = newChar:FindFirstChildOfClass("Humanoid")
            if nh then
                pcall(function() nh.Health = nh.MaxHealth end)
                protect(nh)
            end
            addAuraAndFloat()
            applyAuraColor()
        end
    end)
end

local function disableAll()
    invincible = false
    persistent.on = false
    saveSettings()
    status.Text = "Status: OFF"
    status.TextColor3 = Color3.fromRGB(255,90,90)
    safePlaySound(workspace, "rbxassetid://12222216", 0.9) -- power-down
    if humConn then
        pcall(function() humConn:Disconnect() end)
        humConn = nil
    end
    if charAddedConn then
        pcall(function() charAddedConn:Disconnect() end)
        charAddedConn = nil
    end
    removeAuraAndFloat()
end

-- initial state applying
if persistent.on then
    -- small delay to let UI show
    task.spawn(function()
        task.wait(0.3)
        enableAll()
    end)
end

-- ---------- Buttons and UI behavior ----------
onBtn.MouseButton1Click:Connect(function()
    enableAll()
end)
offBtn.MouseButton1Click:Connect(function()
    disableAll()
end)
closeBtn.MouseButton1Click:Connect(function()
    -- fade out main then destroy
    TweenService:Create(container, TweenInfo.new(0.25), {BackgroundTransparency = 1}):Play()
    task.wait(0.28)
    screen:Destroy()
end)

-- dropdown toggle
local dropOpen = false
auraDrop.MouseButton1Click:Connect(function()
    if dropOpen then
        dropList:TweenSize(UDim2.new(0,160,0,0), TweenInfo.new(0.15), Enum.EasingDirection.Out, Enum.EasingStyle.Quad)
        dropOpen = false
    else
        dropList:TweenSize(UDim2.new(0,160,0,#auraOptions*28), TweenInfo.new(0.15), Enum.EasingDirection.Out, Enum.EasingStyle.Quad)
        dropOpen = true
    end
end)

-- small hover pulse effect for buttons
local function add
